#! /usr/bin/env python

import sqlite3
import os
from tabulate import tabulate

from src.database.ensure_db import ensure_langdb
from src.database.utils import print_table_from_cursor
from src.utils import get_arguments
from src import match_terms


class CommandLineInvocation:
    def __init__(self, workingDir):
        self.workingDir = workingDir
        self.connection = sqlite3.connect('{path}/langbase.sqlite'.format(path=workingDir))
        self.connection.execute("PRAGMA foreign_keys = 1")
        self.cursor = self.connection.cursor()
        self.closeDb = None


def scratch():
    print(tabulate([["value1", "value2"], ["value3", "value4"]], ["column 1", "column 2"], tablefmt="grid"))


def main():
    print('<------- inside: main ------->')
    ROOT_DIR = os.path.dirname(os.path.abspath(__file__))  # This is your Project Root
    invoke = CommandLineInvocation(ROOT_DIR)

    ensure_langdb(invoke)

    invoke.arguments = get_arguments()
    invoke.arguments.term_split = invoke.arguments.term.split(' ')

    match_terms(invoke)

    invoke.connection.commit()
    invoke.connection.close()


main()
